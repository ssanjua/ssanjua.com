---
import SunIcon from "./icons/SunIcon.astro";
import MoonIcon from "./icons/MoonIcon.astro";
---

<button
    id="theme-toggle"
    type="button"
    class="rounded-full text-sm p-2 shadow-md hover:scale-110 transition
        text-gray-500 border border-gray-300 hover:bg-gray-100  hover:border-gray-100 
        dark:text-white/90 dark:border-white/20 dark:hover:bg-white/20 dark:hover:border-white/0"
>
    <MoonIcon id="theme-toggle-dark-icon" class="hover:fill-gray-600 hover:stroke-gray-600 hidden size-5" />
    <SunIcon id="theme-toggle-light-icon" class="hover:fill-yellow-500 hover:stroke-yellow-500 hidden size-5" />
</button>

<script is:inline>
    var themeToggleDarkIcon = document.getElementById("theme-toggle-dark-icon");
    var themeToggleLightIcon = document.getElementById(
        "theme-toggle-light-icon",
    );

    // Change the icons inside the button based on previous settings
    if (
        localStorage.getItem("color-theme") === "dark" ||
        (!("color-theme" in localStorage) &&
            window.matchMedia("(prefers-color-scheme: dark)").matches)
    ) {
        themeToggleLightIcon.classList.remove("hidden");
    } else {
        themeToggleDarkIcon.classList.remove("hidden");
    }

    var themeToggleBtn = document.getElementById("theme-toggle");

    themeToggleBtn.addEventListener("click", function () {
        // toggle icons inside button
        themeToggleDarkIcon.classList.toggle("hidden");
        themeToggleLightIcon.classList.toggle("hidden");

        // if set via local storage previously
        if (localStorage.getItem("color-theme")) {
            if (localStorage.getItem("color-theme") === "light") {
                document.documentElement.classList.add("dark");
                localStorage.setItem("color-theme", "dark");
            } else {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("color-theme", "light");
            }

            // if NOT set via local storage previously
        } else {
            if (document.documentElement.classList.contains("dark")) {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("color-theme", "light");
            } else {
                document.documentElement.classList.add("dark");
                localStorage.setItem("color-theme", "dark");
            }
        }
    });
</script>

<!-- <div class="flex items-center relative ml-1 mr-1">
    <button
        id="theme-toggle-btn"
        class="appearance-none border-none flex hover:scale-125 transition"
        aria-label="Toggle theme"
    >
        <SunIcon id="light" class="size-5 transition-all" />
        <MoonIcon id="dark" class="size-5 transition-all hidden" />
    </button>
</div> -->
